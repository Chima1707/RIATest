!function(){"use strict";function a(a){a.otherwise("/flight-delays")}angular.module("App",["ui.bootstrap","ui.router","LocalForageModule","ui.select","ngSanitize","nvd3"]).config(a).value("moment",moment),a.$inject=["$urlRouterProvider"]}(),function(){"use strict";function a(){function a(){e.isNavbarCollapsed=!e.isNavbarCollapsed}function t(){e.isNavbarCollapsed=!0}var e=this;e.isNavbarCollapsed=!0,e.toggleNavbar=a,e.collapseNavbar=t}angular.module("App").controller("NavbarController",a),a.$inject=[]}(),function(){"use strict";function a(a){a.state("flight-delays",{parent:"app",url:"/flight-delays",views:{"content@":{templateUrl:"app/flight-delays/flight-delays.html",controller:"FlightDelaysController",controllerAs:"vm"}}}),a.state("analysis",{parent:"app",url:"/analysis",views:{"content@":{templateUrl:"app/flight-delays/analysis/analysis.html",controller:"FlightDelaysAnalysisController",controllerAs:"vm"}}})}angular.module("App").config(a),a.$inject=["$stateProvider"]}(),function(){"use strict";function a(a,t,e,i,n,r){function l(a){var t=a.data;return t.split("\n").slice(e.START_INDEX).filter(function(a){return a})}function s(a){return a.map(function(a){function t(a){var t=a.match(/.{1,2}/g).map(Number),e=t[0],i=t[1];return e?60*e+i:i}function i(a){return a.replace(/"/g,"")}function n(a,t){return a/t*100}var r=a.split(","),l=new Date(r[e.FLIGHT_DATE_COL]),s=l.getDay(),o=Number(r[e.DISTANCE_COL]),c=r[e.DEP_TIME_COL];c=i(c);var d=t(c),u=r[e.ARR_TIME_COL];u=i(u);var v=t(u),p=Number(r[e.ELAPSED_TIME_COL]),y=Number(r[e.ARR_DELAY_COL]),h=y>0,m=h?n(y,p):0,g=String(r[e.ORIGIN_COL]);g=i(g);var f=String(r[e.DEST_COL]);return f=i(f),{flightDate:l,day:s,origin:g,destination:f,departureTime:c,departureTimeMin:d,arrivalTime:u,arrivalTimeMin:v,arrivalDelay:y,elapsedTime:p,distance:o,delayed:h,delayRatio:m}})}function o(a){var t={};a.forEach(function(a){t[a.origin]||(t[a.origin]=!0),t[a.destination]||(t[a.destination]=!0)});var e=Object.keys(t);return{data:a,airports:e}}function c(){return y?n.when(y):r.getItem("flightData").then(function(a){return a?(y=a,n.when(y)):n.reject(new Error("data not found"))})}function d(){return a.get(t).then(l).then(s).then(o).then(u)["catch"](n.reject)}function u(a){return r.setItem("flightData",a).then(function(a){y=a})}function v(a,t){var e=[],i=[],n=0;t.filter(function(t){return t.delayed&&t.day===a.day.id&&t.destination===a.destination&&t.origin===a.origin}).forEach(function(a){e.push(a.departureTimeMin),i.push(a.delayRatio),n+=a.delayRatio});var r=i.length?Math.round(n/i.length*100)/100:0;return{delayTimeData:e,delayRatioData:i,averageDelayRatio:r}}function p(a){var t=[],e=[];return a.filter(function(a){return a.delayed}).forEach(function(a){t.push(a.arrivalDelay),e.push(a.distance)}),{delays:t,distances:e}}var y;return{getFlightDelayData:function(){return c()["catch"](d)},queryFlightDelays:v,getDelaysByDistance:p}}angular.module("App").factory("FlightDelayService",a),a.$inject=["$http","DATA_URL","DATA_INFO","moment","$q","$localForage"]}(),function(){"use strict";function a(a,t,e){function i(a,t){var e=[0,t.bins*t.intervals],i=d3.layout.histogram().bins(t.bins).range(e)(a),n={key:"Count",bar:!0,values:[]},r=0;return i.forEach(function(a){r<a.y&&(r=a.y),n.values.push([a.x,a.y])}),t.max=r,[n]}var n=this;n.flightDelayData=e,n.selected={day:"",origin:"",destination:""};var r={arrivalDelayTime:{bins:24,max:0,intervals:60,xAxis:"Hour of the day",yAxis:"Number of arrival delays"},arrivalDelayRatio:{xAxisFormat:function(a){return 10*a},bins:10,max:0,intervals:10,xAxis:"Delay ratio in %",yAxis:"Frequency",drawLine:{value:0,text:"Average(%) is ",chartId:"ratios"}}};n.chartData={arrivalDelaytime:[]},n.histogramOptions={arrivalDelaytime:t.getHistogramOptions(r.arrivalDelayTime)},n.weekDays=[{id:0,name:"Sunday"},{id:1,name:"Monday"},{id:2,name:"Tuesday"},{id:3,name:"Wednesday"},{id:4,name:"Thursday"},{id:5,name:"Friday"},{id:6,name:"Saturday"}],n.enableSearch=function(){return Object.keys(n.selected).every(function(a){return n.selected[a]})},n.search=function(){var e=a.queryFlightDelays(n.selected,n.flightDelayData.data);n.chartData.arrivalDelaytime=i(e.delayTimeData,r.arrivalDelayTime),n.histogramOptions.arrivalDelayTime=t.getHistogramOptions(r.arrivalDelayTime);var l=e.averageDelayRatio;r.arrivalDelayRatio.drawLine.value=l,n.chartData.arrivalDelayRatio=i(e.delayRatioData,r.arrivalDelayRatio),n.histogramOptions.arrivalDelayRatio=t.getHistogramOptions(r.arrivalDelayRatio)}}angular.module("App").controller("FlightDelaysController",a),a.$inject=["FlightDelayService","FlightDelayChartService","flightDelayData"]}(),function(){"use strict";function a(){function a(a){function t(){return a.max?[0,a.max]:[0]}var e=t(),i={chart:{type:"historicalBarChart",margin:{top:20,right:20,bottom:65,left:50},callback:function(t){if(a.drawLine&&a.drawLine.value){var e=t.xAxis.scale(),i=t.margin(),n=d3.select("#"+a.drawLine.chartId+" svg"),r=t.height(),l=e(a.drawLine.value)/a.bins;n.append("line").style("stroke","#FF7F0E").style("stroke-width","2.5px").attr("x1",l+i.left).attr("y1",i.top).attr("x2",l+i.left).attr("y2",r-i.bottom),n.append("text").attr("x",l+i.left).attr("y",i.top).text(a.drawLine.text+""+a.drawLine.value)}},height:300,x:function(a,t){return t},y:function(a){return a[1]},showValues:!0,valueFormat:function(a){return d3.format(",.1f")(a)},duration:100,xAxis:{axisLabel:a.xAxis,tickFormat:function(t){var e=a.xAxisFormat;return e&&angular.isFunction(e)?e(t):t},ticks:a.bins},yAxis:{axisLabel:a.yAxis,axisLabelDistance:-10,tickFormat:function(a){return d3.format(",.1f")(a)}},yDomain:e}};return i}function t(a){var t={chart:{type:"scatterChart",height:600,showDistX:!0,showDistY:!0,tooltipContent:function(a){return"<h3>"+a+"</h3>"},duration:100,useInteractiveGuideline:!0,xAxis:{axisLabel:a.xAxis},yAxis:{axisLabel:a.yAxis,tickFormat:function(a){return d3.format(".02f")(a)},axisLabelDistance:-5}}};return t}return{getHistogramOptions:a,getLineChartOptions:t}}angular.module("App").factory("FlightDelayChartService",a),a.$inject=[]}(),function(){"use strict";function a(a,t,e){function i(){var i=a.getDelaysByDistance(e.data),l=n(i);r.analysis.data=l,r.analysis.options=t.getLineChartOptions(r.chartOptions)}function n(a){var t=a.distances,e=a.delays,i=t.map(function(a,t){return{x:a,y:e[t]}});return[{values:i,key:"distance/arrival delay",strokeWidth:2,classed:"dashed"}]}var r=this;r.chartOptions={xAxis:"Distance in miles",yAxis:"Arrival delay in minutes"},r.analysis={},i()}angular.module("App").controller("FlightDelaysAnalysisController",a),a.$inject=["FlightDelayService","FlightDelayChartService","flightDelayData"]}(),function(){"use strict";function a(a){a.state("app",{"abstract":!0,views:{"navbar@":{templateUrl:"app/layouts/navbar/navbar.html",controller:"NavbarController",controllerAs:"vm"}},resolve:{flightDelayData:["FlightDelayService",function(a){return a.getFlightDelayData()}]}})}angular.module("App").config(a),a.$inject=["$stateProvider"]}(),function(){"use strict";angular.module("App").constant("DEBUG_INFO_ENABLED",!1).constant("DATA_URL","/content/data.csv").constant("DATA",{START_INDEX:1,FLIGHT_DATE_COL:0,ORIGIN_COL:1,DEST_COL:2,DEP_TIME_COL:3,ARR_TIME_COL:4,ARR_DELAY_COL:5,ELAPSED_TIME_COL:6,DISTANCE_COL:7})}(),function(){angular.module("App").run(["$templateCache",function(a){a.put("app/flight-delays/flight-delays.html",'<div><div class="row"><div class="col-md-3"><ui-select ng-model="vm.selected.day" title="Week day" theme="bootstrap"><ui-select-match placeholder="Choose a week day"><span ng-bind="vm.selected.day.name"></span></ui-select-match><ui-select-choices repeat="day in (vm.weekDays | filter: $select.search) track by day.id" position="down"><span ng-bind="day.name"></span></ui-select-choices></ui-select></div><div class="col-md-3"><ui-select ng-model="vm.selected.origin" title="Origin airport"><ui-select-match placeholder="Choose origin airport"><span ng-bind="vm.selected.origin"></span></ui-select-match><ui-select-choices repeat="airport in (vm.flightDelayData.airports | filter: $select.search) track by airport" position="down"><span ng-bind="airport"></span></ui-select-choices></ui-select></div><div class="col-md-3"><ui-select ng-model="vm.selected.destination" title="Destination airport"><ui-select-match placeholder="Choose destination airport"><span ng-bind="vm.selected.destination"></span></ui-select-match><ui-select-choices repeat="airport in (vm.flightDelayData.airports | filter: $select.search) track by airport" position="down"><span ng-bind="airport"></span></ui-select-choices></ui-select></div><div class="col-md-3"><button class="btn btn-primary" ng-click="vm.search()" ng-disabled="!vm.enableSearch()"><span class="glyphicon glyphicon-search"></span> <span>Go</span></button></div></div><div class="vertical-offset-50"></div><div class="row"><div class="col-md-6 col-xm-12"><div class="chart-box radius-primary"><div class="padded-title"><h4>Arrival delays</h4></div><nvd3 options="vm.histogramOptions.arrivalDelayTime" data="vm.chartData.arrivalDelaytime"></nvd3></div></div><div class="col-md-6 col-xm-12"><div class="chart-box radius-primary"><div class="padded-title"><h4>Arrival delay ratio</h4></div><nvd3 id="ratios" options="vm.histogramOptions.arrivalDelayRatio" data="vm.chartData.arrivalDelayRatio"></nvd3></div></div></div></div>'),a.put("app/flight-delays/analysis/analysis.html",'<div class="row"><div class="col-md-12 col-xm-12"><div class="chart-box radius-primary"><div class="padded-title"><h4>Distance and delay analysis chart</h4></div><nvd3 options="vm.analysis.options" data="vm.analysis.data"></nvd3></div></div></div>'),a.put("app/layouts/navbar/navbar.html",'<nav class="navbar navbar-default" role="navigation"><div class="container"><div class="navbar-header"><button type="button" class="navbar-toggle" ng-click="vm.toggleNavbar()"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button> <a class="navbar-brand logo" href="#/" ng-click="vm.collapseNavbar()"><img class="logo-img" src="content/images/logo-jhipster-a30deb26b4.png"> <span>Flight Delay</span></a></div><div class="navbar-collapse" uib-collapse="vm.isNavbarCollapsed"><ul class="nav navbar-nav navbar-left"><li ui-sref-active="active"><a ui-sref="flight-delays" ng-click="vm.collapseNavbar()"><span class="glyphicon glyphicon-clock"></span> <span class="hidden-sm">Arrival delays</span></a></li><li ui-sref-active="active"><a ui-sref="analysis" ng-click="vm.collapseNavbar()"><span class="glyphicon glyphicon-chart"></span> <span class="hidden-sm">Analysis</span></a></li></ul></div></div></nav>')}])}();
//# sourceMappingURL=app-d7ccd8b417.js.map
